ZeroVote
=====================================================

## Info
* Category: crypto
* Point: 500 --> 100
* Description: 
    * This is a challenge from aweinstock
    * [handout](../handout/)
```
nc zerovote.chal.hackthe.vote 1337
```

## Solution
```
Welcome to ZeroVote, your friendly Zero Knowledge voting system!
1) Create ballot
2) Cast vote
3) Exit
> 1
Who do you want to vote for?
a) Alice
b) Bob
c) Carol
> c
Here's your ballot: {"a":{"count":{"point":[16,38,37,249,239,161,89,132,175,31,42,21,245,78,21,20,137,172,79,158,57,169,129,205,150,234,78,159,145,129,21,113]},"x":[111,61,132,31,42,17,186,244,114,131,155,156,145,157,34,123,59,67,79,212,70,101,209,9,87,169,98,84,69,93,165,0]},"b":{"count":{"point":[172,178,36,120,244,110,196,206,191,7,55,153,22,194,130,196,64,119,106,148,43,31,64,116,79,123,178,49,230,77,98,28]},"x":[251,6,60,177,226,30,205,236,23,22,125,19,187,182,90,44,72,167,236,86,235,101,95,231,94,26,143,185,56,134,107,5]},"c":{"count":{"point":[118,132,5,114,17,6,206,4,0,178,187,121,111,229,126,196,35,129,249,118,37,3,20,194,118,111,192,18,187,212,170,27]},"x":[26,136,132,54,102,92,0,180,77,116,41,46,163,82,102,1,92,222,201,21,4,145,180,229,49,154,103,242,244,121,75,13]},"p":{"xh":[224,55,15,196,194,87,16,167,240,62,161,26,130,104,229,69,22,149,197,125,174,180,117,235,183,40,36,189,80,48,114,55],"rh":[20,218,133,63,180,190,82,180,114,77,248,196,59,12,77,102,48,94,180,81,123,25,111,27,62,192,128,180,205,135,112,54],"xcr":[154,158,208,123,35,129,57,208,38,187,91,139,246,78,219,76,58,215,114,198,26,203,95,197,111,229,2,166,184,144,123,12]}}
1) Create ballot
2) Cast vote
3) Exit
> 2
Enter ballot:
{"a":{"count":{"point":[16,38,37,249,239,161,89,132,175,31,42,21,245,78,21,20,137,172,79,158,57,169,129,205,150,234,78,159,145,129,21,113]},"x":[111,61,132,31,42,17,186,244,114,131,155,156,145,157,34,123,59,67,79,212,70,101,209,9,87,169,98,84,69,93,165,0]},"b":{"count":{"point":[172,178,36,120,244,110,196,206,191,7,55,153,22,194,130,196,64,119,106,148,43,31,64,116,79,123,178,49,230,77,98,28]},"x":[251,6,60,177,226,30,205,236,23,22,125,19,187,182,90,44,72,167,236,86,235,101,95,231,94,26,143,185,56,134,107,5]},"c":{"count":{"point":[118,132,5,114,17,6,206,4,0,178,187,121,111,229,126,196,35,129,249,118,37,3,20,194,118,111,192,18,187,212,170,27]},"x":[26,136,132,54,102,92,0,180,77,116,41,46,163,82,102,1,92,222,201,21,4,145,180,229,49,154,103,242,244,121,75,13]},"p":{"xh":[224,55,15,196,194,87,16,167,240,62,161,26,130,104,229,69,22,149,197,125,174,180,117,235,183,40,36,189,80,48,114,55],"rh":[20,218,133,63,180,190,82,180,114,77,248,196,59,12,77,102,48,94,180,81,123,25,111,27,62,192,128,180,205,135,112,54],"xcr":[154,158,208,123,35,129,57,208,38,187,91,139,246,78,219,76,58,215,114,198,26,203,95,197,111,229,2,166,184,144,123,12]}}
Vote counts: Alice 50, Bob 50, Carol 1
```
As can be seen, when you create a ballot and vote for carols, the result is 50, 50, 1
Now we have to look at the source code
```
let (a, b, c) = aggregate.decrypt();
if a > b && a > c {
    println!("Alice wins!");
} else if b > a && b > c {
    println!("Bob wins!");
} else if c > a && c > b {
    println!("Carol wins!");
    let flag = fs::read_to_string("/flag").unwrap();
    println!("Flag: {}", flag);
} else {
    println!("Vote counts: Alice {}, Bob {}, Carol {}", a, b, c);
}
break 'menu;
```
When the vote ballot for Carols higher than Alice and Bob, the flag will be printed out --> We have to change the ballot so that vote for Carols will be higher than others  
Look at the format of the ballot, which is `JSON`, we will change all the elements in array `point` of **"a"** and **"b"** to make the vote for **Alice** and **Bob** become **0**
```
Welcome to ZeroVote, your friendly Zero Knowledge voting system!
1) Create ballot
2) Cast vote
3) Exit
> 2
Enter ballot:
{"a":{"count":{"point":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"x":[111,61,132,31,42,17,186,244,114,131,155,156,145,157,34,123,59,67,79,212,70,101,209,9,87,169,98,84,69,93,165,0]},"b":{"count":{"point":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"x":[251,6,60,177,226,30,205,236,23,22,125,19,187,182,90,44,72,167,236,86,235,101,95,231,94,26,143,185,56,134,107,5]},"c":{"count":{"point":[118,132,5,114,17,6,206,4,0,178,187,121,111,229,126,196,35,129,249,118,37,3,20,194,118,111,192,18,187,212,170,27]},"x":[26,136,132,54,102,92,0,180,77,116,41,46,163,82,102,1,92,222,201,21,4,145,180,229,49,154,103,242,244,121,75,13]},"p":{"xh":[224,55,15,196,194,87,16,167,240,62,161,26,130,104,229,69,22,149,197,125,174,180,117,235,183,40,36,189,80,48,114,55],"rh":[20,218,133,63,180,190,82,180,114,77,248,196,59,12,77,102,48,94,180,81,123,25,111,27,62,192,128,180,205,135,112,54],"xcr":[154,158,208,123,35,129,57,208,38,187,91,139,246,78,219,76,58,215,114,198,26,203,95,197,111,229,2,166,184,144,123,12]}}
Carol wins!
Flag: flag{west_copper_north_north_iron_west_stone}
```
Now when the vote for Carols is 1, bigger than vote for Alice and Bob is 0, the flag appeared.  
--> Flag: `flag{west_copper_north_north_iron_west_stone}`